![header](https://capsule-render.vercel.app/api?type=wave&color=C3E5AE&height=200&section=header&text=Spring&nbsp;Boot&nbsp;Study&fontSize=50&fontColor=000000)

## [12.2.3] RestTemplate ì»¤ìŠ¤í…€ ì„¤ì •
:ballot_box_with_check: RestTemplate ëŠ” HTTPClientë¥¼ ì¶”ìƒí™”í•˜ê³  ìˆì§€ë§Œ, **ê¸°ë³¸ì ìœ¼ë¡œ ì»¤ë„¥ì…˜ í’€ì„ ì§€ì›í•˜ì§€ ì•ŠìŒ.**  

:point_right: Connection Poolì„ ì§€ì›í•˜ì§€ ì•Šìœ¼ë©´?   

* ë§¤ë²ˆ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ í¬íŠ¸ë¥¼ ì—´ì–´ ì»¤ë„¥ì…˜ì„ ìƒì„±í•˜ê²Œ ë˜ëŠ”ë°, TIME_WAIT ìƒíƒœê°€ ëœ ì†Œì¼“ì„ ë‹¤ì‹œ ì‚¬ìš©í•˜ë ¤ê³  ì ‘ê·¼í•œë‹¤ë©´ **ì¬ì‚¬ìš©í•˜ì§€ ëª»í•˜ê²Œ ë¨**
* ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ì„œëŠ” **ì»¤ë„¥ì…˜ í’€ ê¸°ëŠ¥ì„ í™œì„±í™”í•´ì„œ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.**  

âœ”ï¸ ì´ ê¸°ëŠ¥ì„ í™œì„±í™” í•˜ëŠ” ê°€ì¥ ëŒ€í‘œì ì¸ ë°©ë²•ì€ **ì•„íŒŒì¹˜ì—ì„œ ì œê³µí•˜ëŠ” HttpClientë¡œ ëŒ€ì²´í•´ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹**
> **[ì˜ˆì œ 12.7] httpClient ì˜ì¡´ì„± ì¶”ê°€**

```xml
<dependencies>
  ...ìƒëµ...
  <dependency>
    <groupId>org.apache.httpcomponents</groupId>
    <artifactId>httpclient</artifactId>
  </dependency>
</dependencies>  
```

>**[ì˜ˆì œ 12.8] ì»¤ìŠ¤í…€ RestTemplate ê°ì²´ ìƒì„± ë©”ì„œë“œ**

```java
// ì˜ˆì œ 12.8
    public RestTemplate restTemplate() {
        HttpComponentsClientHttpRequestFactory factory = new HttpComponentsClientHttpRequestFactory();

        HttpClient client = HttpClientBuilder.create()
            .setMaxConnTotal(500)
            .setMaxConnPerRoute(500)
            .build();

        CloseableHttpClient httpClient = HttpClients.custom()
            .setMaxConnTotal(500)
            .setMaxConnPerRoute(500)
            .build();

        factory.setHttpClient(httpClient);
        factory.setConnectTimeout(2000);
        factory.setReadTimeout(5000);

        RestTemplate restTemplate = new RestTemplate(factory);

        return restTemplate;
    }
```
âœ”ï¸ RestTemplateì˜ ìƒì„±ìë¥¼ ë³´ë©´ ClientHttpRequestFactoryë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ëŠ” ìƒì„±ìê°€ ì¡´ì¬
```java
public RestTemplate(ClientHttpRequestFactory requestFactory) {
  this();
  setRequestFactory(requestFactory);
}
```   


â¡ï¸ ClientHttpRequestFactory ëŠ” **í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤**ë¡œ, ëŒ€í‘œì ì¸ êµ¬í˜„ì²´ëŠ” **1. SimpleClientHttpRequestFactory ì™€ 2. HttpComponenetsClientHttpRequestFactory** ê°€ ìˆìŒ.  

:one: ë³„ë„ì˜ êµ¬í˜„ì²´ë¥¼ ì„¤ì •í•´ì„œ ì „ë‹¬í•˜ì§€ ì•Šìœ¼ë©´, **HttpAccessorì— êµ¬í˜„ë¼ ìˆëŠ” ë‚´ìš©ì— ì˜í•´ SimpleClientHttpRequestFactoryë¥¼ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.**  

:two: ë³„ë„ì˜ HttpComponentsClientHttpRequestFactory ê°ì²´ë¥¼ ìƒì„±í•´ì„œ ClientHttpRequestFactoryë¥¼ ì‚¬ìš©í•˜ë©´ ```setConnectTimeout(2000);``` , ```setReadTimeout(5000);``` ê³¼ ê°™ì€ RestTemplateì˜ Timeout ì„¤ì •ì„ í•  ìˆ˜ ìˆë‹¤.    

:three: HttpComponentsClientHttpRequestFactoryëŠ” ì»¤ë„¥ì…˜ í’€ì„ ì„¤ì •í•˜ê¸° ìœ„í•´ HttpClientë¥¼ HttpComponentsClientHttpRequestFactoryì— ì„¤ì •í•  ìˆ˜ ìˆìŒ.  

âœ”ï¸ HttpClientë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²• ë‘ê°€ì§€  

1. ```HttpClientBuilder.create()`` ë©”ì„œë“œë¥¼ ì‚¬ìš© 
2. ```HttpClients.custom()``` ë©”ì„œë“œë¥¼ ì‚¬ìš©  

ğŸ‘‰ ìƒì„±í•œ HttpClientëŠ” factoryì˜ **setHttpClient() ë©”ì†Œë“œë¥¼ í†µí•´ ì¸ìë¡œ ì „ë‹¬í•˜ì—¬ ì„¤ì •**í•  ìˆ˜ ìˆë‹¤. ì´í›„ ì´ë ‡ê²Œ ì„¤ì •ëœ factory ê°ì²´ë¥¼ RestTemplateë¥¼ ì´ˆê¸°í™”í•˜ëŠ” ê³¼ì •ì—ì„œ ì¸ìë¡œ ì „ë‹¬í•˜ë©´ ëœë‹¤. 
