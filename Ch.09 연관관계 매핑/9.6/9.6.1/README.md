## 영속성 전이

특정 엔티티의 영속성 상태를 변경할 때 그 엔티티와 연관된 엔티티의 영속성에도 영향을 미쳐 영속성 상태를 변경하는 것

> 영속성  
> 데이터를 생성한 프로그램이 종료되어도 사라지지 않는 데이터의 특성

<br>

@OneToMany와 같이 연관관계와 관련된 애노테이션의 인터페이스를 확인해보면 cascade()라는 요소가 존재함을 확인할 수 있는데, 해당 요소는 영속성 전이를 설정하는 데 활용된다. 해당 요소와 함께 사용하는 영속성 전이 타입은 아래 표와 같다.

| 영속성 전이 타입 종류 | 설명 |
| --- | --- |
| ALL | 모든 영속 상태 변경에 대해 영속성 전이를 적용 |
| PERSIST | 엔티티가 영속화할 때 연관된 엔티티도 함께 영속화 |
| MERGE | 엔티티를 영속성 컨텍스트에 병합할 때 연관된 엔티티도 병합 |
| REMOVE | 엔티티를 제거할 때 연관된 엔티티도 제거 |
| REFRESH | 엔티티를 새로고침할 때 연관된 엔티티도 새로고침 |
| DETACH | 엔티티를 영속성 컨텍스트에서 제외하면 연관된 엔티티도 제외 |

영속성 전이에 사용되는 타입은 엔티티 생명주기와 연관이 있다. 한 엔티티가 cascade() 요소의 값으로 주어진 영속 상태의 변경이 일어나면 매핑으로 연관된 엔티티에도 동일한 동작이 일어나도록 전이를 발생시킨다. cascade()의 리턴 타입은 배열 형식이기 때문에 개발자가 사용하고자 하는 타입을 골라 각 상황에 적용할 수 있다.

이전에는 엔티티를 데이터베이스에 저장하기 위해 각 엔티티를 저장하는 코드를 작성해야 했지만, 영속성 전이 중 PERSIST 타입을 이용할경우 부모 엔티티만을 저장하면 코드에 작성되어 있는 타입에 맞추어 자식 엔티티도 함께 저장할 수 있다.

하지만 자동 설정으로 동작하는 코드들이 정확히 어떤 영향을 미치는지 파악할 필요가 있다는 사실을 꼭 염두에 두고 이용해야한다.
