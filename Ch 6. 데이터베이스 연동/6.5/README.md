# 영속성 컨텍스트
**영속성 컨텍스트의 역할**
- 애플리케이션과 DB 사이에서 엔티티와 레코드의 괴리를 해소하는 기능
- 객체를 보관하는 기능

엔티티 객체가 영속성 컨텍스트에 들어오면 JPA는 엔티티 객체의 매핑 정보를 DB에 반영하는 작업 수행
→ 엔티티 객체가 영속성 컨텍스트에 들어와 JPA의 관리 대상이 되는 시점의 객체를 **영속 객체(Persistence Object)** 라고 함.

<br>

**영속성 컨텍스트의 생명 주기**
- 세션 단위의 생명주기를 가지는데, 이는 DB에 접근하기 위한 세션이 생성되면 영속성 컨텍스트가 만들어지고 세션이 종료되면 영속성 컨텍스트도 없어짐을 의미


## 엔티티 매니저
- 엔티티를 관리하는 객체로, 영속성 컨텍스트와 DB를 비교하면서 실제 DB에 CRUD 작업 수행
- 엔티티를 영속성 컨텍스트에 추가해서 영속 객체로 만드는 작업 수행

**엔티티 매니저 팩토리**
- 엔티티 매니저를 만드는 객체로, 이는 DB에 대응하는 객체로서 스프링 부트에서는 자동 설정 기능이 있기에 `application.properties`에서 작성한 최소한의 설정만으로도 동작하지만 JPA의 구현체 중 하나인 하이버네이트에서는 `persistence.xml`이라는 설정 파일을 구성하고 사용해야 함.
- 애플리케이션에서 단 하나만 생성되며, 모든 엔티티가 공유해서 사용


## 엔티티의 생명 주기
엔티티 객체는 영속성 컨텍스트에서 다음과 같은 4가지 상태로 구분

**비영속(New)**
- 영속성 컨텍스트에 추가되지 않은 엔티티 객체의 상태

**영속(Managed)**
- 영속성 컨텍스트에 의해 엔티티 객체가 관리되는 상태

**준영속(Detached)**
- 영속성 컨텍스트에 의해 관리되던 엔티티 객체가 컨텍스트와 분리된 상태

**삭제(Removed)**
- DB에서 레코드를 삭제하기 위해 영속성 컨텍스트에 삭제 요청을 한 상태
